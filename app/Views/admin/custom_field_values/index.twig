{% extends 'admin/_layout.twig' %}
{% block title %}{{ type.label }} — {{ trans('admin.custom_fields.values') }} — Cimaise{% endblock %}
{% block content %}
  <div class="flex items-center justify-between mb-8">
    <div>
      <div class="flex items-center text-sm text-gray-500 mb-2">
        <a href="{{ base_path }}/admin/custom-field-types" class="hover:text-gray-700">{{ trans('admin.custom_fields.title') }}</a>
        <i class="fas fa-chevron-right mx-2 text-xs"></i>
        <span>{{ type.label }}</span>
      </div>
      <h1 class="text-2xl font-bold text-gray-900">
        <i class="fas {{ type.icon }} mr-2 text-gray-600"></i>
        {{ trans('admin.custom_fields.values_for') }} "{{ type.label }}"
      </h1>
      {% if type.description %}
        <p class="text-gray-600 mt-1">{{ type.description }}</p>
      {% endif %}
    </div>
    <a href="{{ base_path }}/admin/custom-field-types/{{ type.id }}/edit" class="btn-secondary">
      <i class="fas fa-edit mr-2"></i>{{ trans('admin.custom_fields.edit_type') }}
    </a>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    {# Add new value form #}
    <div class="lg:col-span-1">
      <div class="card p-6">
        <h3 class="text-lg font-medium text-gray-900 mb-4">{{ trans('admin.custom_fields.add_value') }}</h3>
        <form method="post" action="{{ base_path }}/admin/custom-field-types/{{ type.id }}/values" class="space-y-4">
          <input type="hidden" name="csrf" value="{{ csrf }}">

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              {{ trans('admin.custom_fields.value') }} <span class="text-red-500">*</span>
            </label>
            <input class="form-input" type="text" name="value" required placeholder="{{ trans('admin.custom_fields.value_placeholder') }}">
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">{{ trans('admin.custom_fields.extra_data') }}</label>
            <textarea class="form-input" name="extra_data" rows="2" placeholder="{{ trans('admin.custom_fields.extra_data_placeholder') }}"></textarea>
            <p class="mt-1 text-xs text-gray-500">{{ trans('admin.custom_fields.extra_data_hint') }}</p>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">{{ trans('admin.custom_fields.sort_order') }}</label>
            <input class="form-input w-24" type="number" name="sort_order" value="0" min="0">
          </div>

          <button class="btn-primary w-full" type="submit">
            <i class="fas fa-plus mr-2"></i>{{ trans('admin.custom_fields.add_value') }}
          </button>
        </form>
      </div>
    </div>

    {# Values list #}
    <div class="lg:col-span-2">
      <div class="card">
        <div class="overflow-x-auto">
          <table class="min-w-full">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ trans('admin.custom_fields.value') }}</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ trans('admin.custom_fields.extra_data') }}</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">{{ trans('admin.custom_fields.sort_order') }}</th>
                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">{{ trans('admin.common.actions') }}</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200" id="values-list">
              {% for val in values %}
              <tr class="table-row" data-id="{{ val.id }}">
                <td class="px-6 py-4">
                  <div class="text-sm font-medium text-gray-900">{{ val.value }}</div>
                </td>
                <td class="px-6 py-4">
                  {% if val.extra_data %}
                    <code class="text-xs bg-gray-100 px-2 py-1 rounded">{{ val.extra_data|slice(0, 30) }}{% if val.extra_data|length > 30 %}...{% endif %}</code>
                  {% else %}
                    <span class="text-gray-400 text-sm">—</span>
                  {% endif %}
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="text-sm text-gray-600">{{ val.sort_order }}</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                  <form method="post" action="{{ base_path }}/admin/custom-field-types/{{ type.id }}/values/{{ val.id }}/delete" class="inline" data-confirm="{{ trans('admin.custom_fields.delete_value_confirm')|e('html_attr') }}">
                    <input type="hidden" name="csrf" value="{{ csrf }}">
                    <button type="submit" class="text-red-600 hover:text-red-800 transition-colors">
                      <i class="fas fa-trash"></i>
                    </button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        {% if values|length == 0 %}
          <div class="text-center py-12">
            <i class="fas fa-list text-4xl text-gray-300 mb-4"></i>
            <h3 class="text-lg font-medium text-gray-900 mb-2">{{ trans('admin.custom_fields.no_values') }}</h3>
            <p class="text-gray-600">{{ trans('admin.custom_fields.no_values_hint') }}</p>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
{% endblock %}
