{% extends "admin/_layout.twig" %}

{% block title %}{{ trans('admin.seo.title') }} — Cimaise{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <div class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">{{ trans('admin.seo.title') }}</h1>
          <p class="mt-2 text-gray-600">{{ trans('admin.seo.description') }}</p>
        </div>
        <div class="flex items-center gap-3">
          <button type="submit" form="seo-form" class="btn-primary">
            <i class="fas fa-save mr-2"></i>
            {{ trans('admin.seo.save_settings') }}
          </button>
          <button type="submit" form="sitemap-form" class="btn-secondary">
            <i class="fas fa-sitemap mr-2"></i>
            {{ trans('admin.seo.generate_sitemap') }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sticky Footer with Action Buttons -->
  <div class="fixed bottom-0 left-64 right-0 bg-white border-t border-gray-200 shadow-lg z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button type="submit" form="seo-form" class="btn-primary">
            <i class="fas fa-save mr-2"></i>
            {{ trans('admin.seo.save_settings') }}
          </button>
          <a href="{{ base_path }}/admin" class="btn-secondary">
            <i class="fas fa-arrow-left mr-2"></i>
            {{ trans('admin.common.dashboard') }}
          </a>
        </div>

        <div class="text-sm text-gray-500">
          <i class="fas fa-info-circle mr-1"></i>
          {{ trans('admin.seo.configure_hint') }}
        </div>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24">
    <form id="seo-form" method="post" action="{{ base_path }}/admin/seo" class="space-y-8">
      <input type="hidden" name="csrf" value="{{ csrf }}">

      <!-- Site-wide SEO Settings -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-globe mr-3 text-blue-600"></i>
            {{ trans('admin.seo.sitewide_seo') }}
          </h2>
          <p class="text-sm text-gray-600 mt-1">{{ trans('admin.seo.sitewide_seo_hint') }}</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.site_title') }}</label>
              <input type="text" name="site_title" class="form-input" value="{{ settings.site_title }}" placeholder="{{ trans('admin.seo.site_title_placeholder') }}">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.site_title_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.author_name') }}</label>
              <input type="text" name="author_name" class="form-input" value="{{ settings.author_name }}" placeholder="{{ trans('admin.seo.author_name_placeholder') }}">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.author_name_hint') }}</p>
            </div>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.site_description_label') }}</label>
            <textarea name="site_description" rows="3" class="form-input" placeholder="{{ trans('admin.seo.site_description_placeholder') }}">{{ settings.site_description }}</textarea>
            <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.site_description_hint') }}</p>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.keywords') }}</label>
            <input type="text" name="site_keywords" class="form-input" value="{{ settings.site_keywords }}" placeholder="{{ trans('admin.seo.keywords_placeholder') }}">
            <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.keywords_hint') }}</p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.author_url') }}</label>
              <input type="url" name="author_url" class="form-input" value="{{ settings.author_url }}" placeholder="https://yourwebsite.com">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.author_url_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.organization_name') }}</label>
              <input type="text" name="organization_name" class="form-input" value="{{ settings.organization_name }}" placeholder="{{ trans('admin.seo.organization_name_placeholder') }}">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.organization_name_hint') }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Open Graph & Social Media -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fab fa-facebook mr-3 text-blue-600"></i>
            {{ trans('admin.seo.open_graph') }}
          </h2>
          <p class="text-sm text-gray-600 mt-1">{{ trans('admin.seo.open_graph_hint') }}</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.og_site_name') }}</label>
              <input type="text" name="og_site_name" class="form-input" value="{{ settings.og_site_name }}" placeholder="{{ trans('admin.seo.og_site_name_placeholder') }}">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.og_site_name_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.content_type') }}</label>
              <select name="og_type" class="form-input">
                <option value="website" {{ settings.og_type == 'website' ? 'selected' : '' }}>{{ trans('admin.seo.type_website') }}</option>
                <option value="profile" {{ settings.og_type == 'profile' ? 'selected' : '' }}>{{ trans('admin.seo.type_profile') }}</option>
                <option value="article" {{ settings.og_type == 'article' ? 'selected' : '' }}>{{ trans('admin.seo.type_article') }}</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.locale') }}</label>
              <select name="og_locale" class="form-input">
                <option value="en_US" {{ settings.og_locale == 'en_US' ? 'selected' : '' }}>{{ trans('admin.seo.locale_en_us') }}</option>
                <option value="en_GB" {{ settings.og_locale == 'en_GB' ? 'selected' : '' }}>{{ trans('admin.seo.locale_en_gb') }}</option>
                <option value="it_IT" {{ settings.og_locale == 'it_IT' ? 'selected' : '' }}>{{ trans('admin.seo.locale_it') }}</option>
                <option value="fr_FR" {{ settings.og_locale == 'fr_FR' ? 'selected' : '' }}>{{ trans('admin.seo.locale_fr') }}</option>
                <option value="de_DE" {{ settings.og_locale == 'de_DE' ? 'selected' : '' }}>{{ trans('admin.seo.locale_de') }}</option>
                <option value="es_ES" {{ settings.og_locale == 'es_ES' ? 'selected' : '' }}>{{ trans('admin.seo.locale_es') }}</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.twitter_card_type') }}</label>
              <select name="twitter_card" class="form-input">
                <option value="summary_large_image" {{ settings.twitter_card == 'summary_large_image' ? 'selected' : '' }}>{{ trans('admin.seo.twitter_large_image') }}</option>
                <option value="summary" {{ settings.twitter_card == 'summary' ? 'selected' : '' }}>{{ trans('admin.seo.twitter_summary') }}</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.twitter_site') }}</label>
              <input type="text" name="twitter_site" class="form-input" value="{{ settings.twitter_site }}" placeholder="@yourusername">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.twitter_site_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.twitter_creator') }}</label>
              <input type="text" name="twitter_creator" class="form-input" value="{{ settings.twitter_creator }}" placeholder="@yourusername">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.twitter_creator_hint') }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Schema.org & Structured Data -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-code mr-3 text-green-600"></i>
            {{ trans('admin.seo.schema_structured_data') }}
          </h2>
          <p class="text-sm text-gray-600 mt-1">{{ trans('admin.seo.schema_hint') }}</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="schema_enabled" value="1" class="sr-only peer" {{ settings.schema_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.enable_schema') }}</span>
            </label>

            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="breadcrumbs_enabled" value="1" class="sr-only peer" {{ settings.breadcrumbs_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.enable_breadcrumbs') }}</span>
            </label>
          </div>

          <!-- Professional Photographer Schema -->
          <div class="border border-gray-200 rounded-lg p-4">
            <h3 class="text-md font-medium text-gray-900 mb-4 flex items-center">
              <i class="fas fa-camera mr-2 text-purple-600"></i>
              {{ trans('admin.seo.photographer_schema') }}
            </h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.job_title') }}</label>
                <input type="text" name="photographer_job_title" class="form-input" value="{{ settings.photographer_job_title }}" placeholder="{{ trans('admin.seo.job_title_placeholder') }}">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.services_offered') }}</label>
                <input type="text" name="photographer_services" class="form-input" value="{{ settings.photographer_services }}" placeholder="{{ trans('admin.seo.services_placeholder') }}">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.area_served') }}</label>
                <input type="text" name="photographer_area_served" class="form-input" value="{{ settings.photographer_area_served }}" placeholder="{{ trans('admin.seo.area_served_placeholder') }}">
                <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.area_served_hint') }}</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.social_media_links') }}</label>
                <textarea name="photographer_same_as" rows="3" class="form-input" placeholder="https://instagram.com/username&#10;https://facebook.com/page&#10;https://linkedin.com/in/profile">{{ settings.photographer_same_as }}</textarea>
                <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.social_media_hint') }}</p>
              </div>
            </div>
          </div>

          <!-- Local Business Schema -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-md font-medium text-gray-900 flex items-center">
                <i class="fas fa-map-marker-alt mr-2 text-red-600"></i>
                {{ trans('admin.seo.local_business_schema') }}
              </h3>
              <label class="flex items-center cursor-pointer">
                <input type="checkbox" name="local_business_enabled" value="1" class="sr-only peer" {{ settings.local_business_enabled ? 'checked' : '' }}>
                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.enable_local_business') }}</span>
              </label>
            </div>
            
            <div id="local-business-fields" class="{{ settings.local_business_enabled ? '' : 'opacity-50 pointer-events-none' }}">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.business_name') }}</label>
                  <input type="text" name="local_business_name" class="form-input" value="{{ settings.local_business_name }}" placeholder="{{ trans('admin.seo.business_name_placeholder') }}">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.business_type') }}</label>
                  <select name="local_business_type" class="form-input">
                    <option value="ProfessionalService" {{ settings.local_business_type == 'ProfessionalService' ? 'selected' : '' }}>{{ trans('admin.seo.professional_service') }}</option>
                    <option value="LocalBusiness" {{ settings.local_business_type == 'LocalBusiness' ? 'selected' : '' }}>{{ trans('admin.seo.local_business') }}</option>
                    <option value="Store" {{ settings.local_business_type == 'Store' ? 'selected' : '' }}>{{ trans('admin.seo.store') }}</option>
                  </select>
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
                <div class="lg:col-span-2">
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.address') }}</label>
                  <input type="text" name="local_business_address" class="form-input" value="{{ settings.local_business_address }}" placeholder="{{ trans('admin.seo.address_placeholder') }}">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.phone') }}</label>
                  <input type="tel" name="local_business_phone" class="form-input" value="{{ settings.local_business_phone }}" placeholder="+1-555-123-4567">
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.city') }}</label>
                  <input type="text" name="local_business_city" class="form-input" value="{{ settings.local_business_city }}" placeholder="{{ trans('admin.seo.city_placeholder') }}">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.postal_code') }}</label>
                  <input type="text" name="local_business_postal_code" class="form-input" value="{{ settings.local_business_postal_code }}" placeholder="10001">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.country') }}</label>
                  <input type="text" name="local_business_country" class="form-input" value="{{ settings.local_business_country }}" placeholder="US">
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.latitude') }}</label>
                  <input type="text" name="local_business_geo_lat" class="form-input" value="{{ settings.local_business_geo_lat }}" placeholder="40.7128">
                  <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.geo_hint') }}</p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.longitude') }}</label>
                  <input type="text" name="local_business_geo_lng" class="form-input" value="{{ settings.local_business_geo_lng }}" placeholder="-74.0060">
                </div>
              </div>
              
              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.opening_hours') }}</label>
                <textarea name="local_business_opening_hours" rows="3" class="form-input" placeholder="Mo-Fr 09:00-18:00&#10;Sa 10:00-16:00">{{ settings.local_business_opening_hours }}</textarea>
                <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.opening_hours_hint') }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical SEO -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-cogs mr-3 text-gray-600"></i>
            {{ trans('admin.seo.technical_seo') }}
          </h2>
          <p class="text-sm text-gray-600 mt-1">{{ trans('admin.seo.technical_seo_hint') }}</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.robots_meta') }}</label>
              <select name="robots_default" class="form-input">
                <option value="index,follow" {{ settings.robots_default == 'index,follow' ? 'selected' : '' }}>{{ trans('admin.seo.index_follow') }}</option>
                <option value="index,nofollow" {{ settings.robots_default == 'index,nofollow' ? 'selected' : '' }}>{{ trans('admin.seo.index_nofollow') }}</option>
                <option value="noindex,follow" {{ settings.robots_default == 'noindex,follow' ? 'selected' : '' }}>{{ trans('admin.seo.noindex_follow') }}</option>
                <option value="noindex,nofollow" {{ settings.robots_default == 'noindex,nofollow' ? 'selected' : '' }}>{{ trans('admin.seo.noindex_nofollow') }}</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.canonical_url') }}</label>
              <input type="url" name="canonical_base_url" class="form-input" value="{{ settings.canonical_base_url }}" placeholder="https://yourwebsite.com">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.canonical_url_hint') }}</p>
            </div>
          </div>
          
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="sitemap_enabled" value="1" class="sr-only peer" {{ settings.sitemap_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.enable_sitemap') }}</span>
            </label>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.google_analytics') }}</label>
              <input type="text" name="analytics_gtag" class="form-input" value="{{ settings.analytics_gtag }}" placeholder="G-XXXXXXXXXX">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.google_analytics_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.google_tag_manager') }}</label>
              <input type="text" name="analytics_gtm" class="form-input" value="{{ settings.analytics_gtm }}" placeholder="GTM-XXXXXXX">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.google_tag_manager_hint') }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Image SEO -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-image mr-3 text-yellow-600"></i>
            {{ trans('admin.seo.image_seo') }}
          </h2>
          <p class="text-sm text-gray-600 mt-1">{{ trans('admin.seo.image_seo_hint') }}</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="image_alt_auto" value="1" class="sr-only peer" {{ settings.image_alt_auto ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.auto_alt_text') }}</span>
            </label>

            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="preload_critical_images" value="1" class="sr-only peer" {{ settings.preload_critical_images ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.preload_critical') }}</span>
            </label>

            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="lazy_load_images" value="1" class="sr-only peer" {{ settings.lazy_load_images ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">{{ trans('admin.seo.lazy_loading') }}</span>
            </label>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.copyright_notice') }}</label>
            <input type="text" name="image_copyright_notice" class="form-input" value="{{ settings.image_copyright_notice }}" placeholder="© {year} Your Name. All rights reserved.">
            <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.copyright_hint') }}</p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.license_url') }}</label>
              <input type="url" name="image_license_url" class="form-input" value="{{ settings.image_license_url }}" placeholder="https://creativecommons.org/licenses/by-nc/4.0/">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.license_url_hint') }}</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">{{ trans('admin.seo.license_purchase') }}</label>
              <input type="url" name="image_acquire_license_page" class="form-input" value="{{ settings.image_acquire_license_page }}" placeholder="https://yourwebsite.com/licensing">
              <p class="text-xs text-gray-500 mt-1">{{ trans('admin.seo.license_purchase_hint') }}</p>
            </div>
          </div>
        </div>
      </div>
    </form>

    <!-- Separate Sitemap Form -->
    <form id="sitemap-form" method="post" action="{{ base_path }}/admin/seo/sitemap" class="hidden">
      <input type="hidden" name="csrf" value="{{ csrf }}">
    </form>
  </div>
</div>

<script nonce="{{ csp_nonce() }}">
// SEO page initialization - Compatible with SPA
function initializeSEOPage() {
  // Local business toggle
  const localBusinessToggle = document.querySelector('input[name="local_business_enabled"]');
  const localBusinessFields = document.getElementById('local-business-fields');
  
  if (localBusinessToggle && localBusinessFields) {
    // Remove any existing event listeners to prevent duplicates
    localBusinessToggle.removeEventListener('change', handleLocalBusinessToggle);
    localBusinessToggle.addEventListener('change', handleLocalBusinessToggle);
    
    // Set initial state
    handleLocalBusinessToggle.call(localBusinessToggle);
  }
  
  // Form validation
  const form = document.getElementById('seo-form');
  if (form) {
    // Remove existing listener to prevent duplicates
    form.removeEventListener('submit', handleSEOFormSubmit);
    form.addEventListener('submit', handleSEOFormSubmit);
  }
}

// Event handler functions
function handleLocalBusinessToggle() {
  const localBusinessFields = document.getElementById('local-business-fields');
  if (localBusinessFields) {
    if (this.checked) {
      localBusinessFields.classList.remove('opacity-50', 'pointer-events-none');
    } else {
      localBusinessFields.classList.add('opacity-50', 'pointer-events-none');
    }
  }
}

function handleSEOFormSubmit(e) {
  const canonicalUrl = document.querySelector('input[name="canonical_base_url"]')?.value;
  const sitemapEnabled = document.querySelector('input[name="sitemap_enabled"]')?.checked;
  
  if (sitemapEnabled && !canonicalUrl) {
    e.preventDefault();
    alert('{{ trans('admin.seo.canonical_required')|e('js') }}');
    return false;
  }
}

// Initialize on DOM ready
document.addEventListener('DOMContentLoaded', initializeSEOPage);

// Make initialization function globally available for SPA re-initialization
if (!window.pageInitializers) {
  window.pageInitializers = {};
}
window.pageInitializers.seo = initializeSEOPage;

// Auto-initialize if this is loaded in SPA context
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeSEOPage);
} else {
  initializeSEOPage();
}
</script>
{% endblock %}
