{% extends "admin/_layout.twig" %}

{% block title %}SEO Settings — photoCMS{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <div class="bg-white shadow-sm border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex items-center justify-between">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">SEO Settings</h1>
          <p class="mt-2 text-gray-600">Configure SEO, schema markup, and metadata for your photography portfolio</p>
        </div>
        <div class="flex items-center gap-3">
          <button type="submit" form="seo-form" class="btn-primary">
            <i class="fas fa-save mr-2"></i>
            Save Settings
          </button>
          <button type="submit" form="sitemap-form" class="btn-secondary">
            <i class="fas fa-sitemap mr-2"></i>
            Generate Sitemap
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sticky Footer with Action Buttons -->
  <div class="fixed bottom-0 left-0 lg:left-64 right-0 bg-white border-t border-gray-200 shadow-lg z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <button type="submit" form="seo-form" class="btn-primary">
            <i class="fas fa-save mr-2"></i>
            Save Settings
          </button>
          <a href="{{ base_path }}/admin" class="btn-secondary">
            <i class="fas fa-arrow-left mr-2"></i>
            Dashboard
          </a>
        </div>
        
        <div class="text-sm text-gray-500">
          <i class="fas fa-info-circle mr-1"></i>
          Configure SEO settings for your photography portfolio
        </div>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24">
    <form id="seo-form" method="post" action="{{ base_path }}/admin/seo" class="space-y-8">
      <input type="hidden" name="csrf" value="{{ csrf }}">

      <!-- Site-wide SEO Settings -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-globe mr-3 text-blue-600"></i>
            Site-wide SEO
          </h2>
          <p class="text-sm text-gray-600 mt-1">Basic SEO settings that apply to your entire website</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Site Title</label>
              <input type="text" name="site_title" class="form-input" value="{{ settings.site_title }}" placeholder="Photography Portfolio">
              <p class="text-xs text-gray-500 mt-1">Main title of your website (used in title tags)</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Author Name</label>
              <input type="text" name="author_name" class="form-input" value="{{ settings.author_name }}" placeholder="Your Name">
              <p class="text-xs text-gray-500 mt-1">Your name as the photographer/author</p>
            </div>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Site Description</label>
            <textarea name="site_description" rows="3" class="form-input" placeholder="Professional photography portfolio showcasing creative work and artistic vision">{{ settings.site_description }}</textarea>
            <p class="text-xs text-gray-500 mt-1">Default meta description for your website</p>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Keywords</label>
            <input type="text" name="site_keywords" class="form-input" value="{{ settings.site_keywords }}" placeholder="photography, portfolio, professional photographer, creative photography">
            <p class="text-xs text-gray-500 mt-1">Comma-separated keywords that describe your work</p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Author URL</label>
              <input type="url" name="author_url" class="form-input" value="{{ settings.author_url }}" placeholder="https://yourwebsite.com">
              <p class="text-xs text-gray-500 mt-1">Your personal or portfolio website URL</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Organization Name</label>
              <input type="text" name="organization_name" class="form-input" value="{{ settings.organization_name }}" placeholder="Your Studio Name">
              <p class="text-xs text-gray-500 mt-1">Studio or business name (if applicable)</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Open Graph & Social Media -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fab fa-facebook mr-3 text-blue-600"></i>
            Open Graph & Social Media
          </h2>
          <p class="text-sm text-gray-600 mt-1">Settings for how your content appears when shared on social media</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Site Name (Open Graph)</label>
              <input type="text" name="og_site_name" class="form-input" value="{{ settings.og_site_name }}" placeholder="Photography Portfolio">
              <p class="text-xs text-gray-500 mt-1">Name of your site for Open Graph</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Content Type</label>
              <select name="og_type" class="form-input">
                <option value="website" {{ settings.og_type == 'website' ? 'selected' : '' }}>Website</option>
                <option value="profile" {{ settings.og_type == 'profile' ? 'selected' : '' }}>Profile</option>
                <option value="article" {{ settings.og_type == 'article' ? 'selected' : '' }}>Article</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Locale</label>
              <select name="og_locale" class="form-input">
                <option value="en_US" {{ settings.og_locale == 'en_US' ? 'selected' : '' }}>English (US)</option>
                <option value="en_GB" {{ settings.og_locale == 'en_GB' ? 'selected' : '' }}>English (UK)</option>
                <option value="it_IT" {{ settings.og_locale == 'it_IT' ? 'selected' : '' }}>Italian</option>
                <option value="fr_FR" {{ settings.og_locale == 'fr_FR' ? 'selected' : '' }}>French</option>
                <option value="de_DE" {{ settings.og_locale == 'de_DE' ? 'selected' : '' }}>German</option>
                <option value="es_ES" {{ settings.og_locale == 'es_ES' ? 'selected' : '' }}>Spanish</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Twitter Card Type</label>
              <select name="twitter_card" class="form-input">
                <option value="summary_large_image" {{ settings.twitter_card == 'summary_large_image' ? 'selected' : '' }}>Large Image</option>
                <option value="summary" {{ settings.twitter_card == 'summary' ? 'selected' : '' }}>Summary</option>
              </select>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Twitter Site</label>
              <input type="text" name="twitter_site" class="form-input" value="{{ settings.twitter_site }}" placeholder="@yourusername">
              <p class="text-xs text-gray-500 mt-1">Your Twitter username (with @)</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Twitter Creator</label>
              <input type="text" name="twitter_creator" class="form-input" value="{{ settings.twitter_creator }}" placeholder="@yourusername">
              <p class="text-xs text-gray-500 mt-1">Content creator Twitter username</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Schema.org & Structured Data -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-code mr-3 text-green-600"></i>
            Schema.org & Structured Data
          </h2>
          <p class="text-sm text-gray-600 mt-1">Configure structured data markup for better search engine understanding</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="schema_enabled" value="1" class="sr-only peer" {{ settings.schema_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Enable Schema.org markup</span>
            </label>
            
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="breadcrumbs_enabled" value="1" class="sr-only peer" {{ settings.breadcrumbs_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Enable breadcrumbs schema</span>
            </label>
          </div>

          <!-- Professional Photographer Schema -->
          <div class="border border-gray-200 rounded-lg p-4">
            <h3 class="text-md font-medium text-gray-900 mb-4 flex items-center">
              <i class="fas fa-camera mr-2 text-purple-600"></i>
              Professional Photographer Schema
            </h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Job Title</label>
                <input type="text" name="photographer_job_title" class="form-input" value="{{ settings.photographer_job_title }}" placeholder="Professional Photographer">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Services Offered</label>
                <input type="text" name="photographer_services" class="form-input" value="{{ settings.photographer_services }}" placeholder="Professional Photography Services">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Area Served</label>
                <input type="text" name="photographer_area_served" class="form-input" value="{{ settings.photographer_area_served }}" placeholder="New York, NY">
                <p class="text-xs text-gray-500 mt-1">Geographic area you serve</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Social Media Links</label>
                <textarea name="photographer_same_as" rows="3" class="form-input" placeholder="https://instagram.com/username&#10;https://facebook.com/page&#10;https://linkedin.com/in/profile">{{ settings.photographer_same_as }}</textarea>
                <p class="text-xs text-gray-500 mt-1">One URL per line (Instagram, Facebook, LinkedIn, etc.)</p>
              </div>
            </div>
          </div>

          <!-- Local Business Schema -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-md font-medium text-gray-900 flex items-center">
                <i class="fas fa-map-marker-alt mr-2 text-red-600"></i>
                Local Business Schema
              </h3>
              <label class="flex items-center cursor-pointer">
                <input type="checkbox" name="local_business_enabled" value="1" class="sr-only peer" {{ settings.local_business_enabled ? 'checked' : '' }}>
                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                <span class="ml-3 text-sm font-medium text-gray-900">Enable Local Business</span>
              </label>
            </div>
            
            <div id="local-business-fields" class="{{ settings.local_business_enabled ? '' : 'opacity-50 pointer-events-none' }}">
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Business Name</label>
                  <input type="text" name="local_business_name" class="form-input" value="{{ settings.local_business_name }}" placeholder="Your Studio Name">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Business Type</label>
                  <select name="local_business_type" class="form-input">
                    <option value="ProfessionalService" {{ settings.local_business_type == 'ProfessionalService' ? 'selected' : '' }}>Professional Service</option>
                    <option value="LocalBusiness" {{ settings.local_business_type == 'LocalBusiness' ? 'selected' : '' }}>Local Business</option>
                    <option value="Store" {{ settings.local_business_type == 'Store' ? 'selected' : '' }}>Store</option>
                  </select>
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
                <div class="lg:col-span-2">
                  <label class="block text-sm font-medium text-gray-700 mb-2">Address</label>
                  <input type="text" name="local_business_address" class="form-input" value="{{ settings.local_business_address }}" placeholder="123 Main Street">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Phone</label>
                  <input type="tel" name="local_business_phone" class="form-input" value="{{ settings.local_business_phone }}" placeholder="+1-555-123-4567">
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">City</label>
                  <input type="text" name="local_business_city" class="form-input" value="{{ settings.local_business_city }}" placeholder="New York">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Postal Code</label>
                  <input type="text" name="local_business_postal_code" class="form-input" value="{{ settings.local_business_postal_code }}" placeholder="10001">
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Country</label>
                  <input type="text" name="local_business_country" class="form-input" value="{{ settings.local_business_country }}" placeholder="US">
                </div>
              </div>
              
              <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Latitude</label>
                  <input type="text" name="local_business_geo_lat" class="form-input" value="{{ settings.local_business_geo_lat }}" placeholder="40.7128">
                  <p class="text-xs text-gray-500 mt-1">Geographic coordinates for maps</p>
                </div>
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-2">Longitude</label>
                  <input type="text" name="local_business_geo_lng" class="form-input" value="{{ settings.local_business_geo_lng }}" placeholder="-74.0060">
                </div>
              </div>
              
              <div class="mt-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">Opening Hours</label>
                <textarea name="local_business_opening_hours" rows="3" class="form-input" placeholder="Mo-Fr 09:00-18:00&#10;Sa 10:00-16:00">{{ settings.local_business_opening_hours }}</textarea>
                <p class="text-xs text-gray-500 mt-1">One time range per line (e.g., Mo-Fr 09:00-18:00)</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical SEO -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-cogs mr-3 text-gray-600"></i>
            Technical SEO
          </h2>
          <p class="text-sm text-gray-600 mt-1">Technical settings for search engines and crawlers</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Default Robots Meta</label>
              <select name="robots_default" class="form-input">
                <option value="index,follow" {{ settings.robots_default == 'index,follow' ? 'selected' : '' }}>Index, Follow</option>
                <option value="index,nofollow" {{ settings.robots_default == 'index,nofollow' ? 'selected' : '' }}>Index, No Follow</option>
                <option value="noindex,follow" {{ settings.robots_default == 'noindex,follow' ? 'selected' : '' }}>No Index, Follow</option>
                <option value="noindex,nofollow" {{ settings.robots_default == 'noindex,nofollow' ? 'selected' : '' }}>No Index, No Follow</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Canonical Base URL</label>
              <input type="url" name="canonical_base_url" class="form-input" value="{{ settings.canonical_base_url }}" placeholder="https://yourwebsite.com">
              <p class="text-xs text-gray-500 mt-1">Base URL for canonical links and sitemap</p>
            </div>
          </div>
          
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="sitemap_enabled" value="1" class="sr-only peer" {{ settings.sitemap_enabled ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Enable XML sitemap</span>
            </label>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Google Analytics (gtag)</label>
              <input type="text" name="analytics_gtag" class="form-input" value="{{ settings.analytics_gtag }}" placeholder="G-XXXXXXXXXX">
              <p class="text-xs text-gray-500 mt-1">Google Analytics 4 Measurement ID</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Google Tag Manager</label>
              <input type="text" name="analytics_gtm" class="form-input" value="{{ settings.analytics_gtm }}" placeholder="GTM-XXXXXXX">
              <p class="text-xs text-gray-500 mt-1">Google Tag Manager Container ID</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Image SEO -->
      <div class="card">
        <div class="bg-gray-50 px-6 py-4 border-b border-gray-200">
          <h2 class="text-lg font-medium text-gray-900 flex items-center">
            <i class="fas fa-image mr-3 text-yellow-600"></i>
            Image SEO & Copyright
          </h2>
          <p class="text-sm text-gray-600 mt-1">Settings for image optimization and copyright protection</p>
        </div>
        <div class="p-6 space-y-6">
          <div class="flex items-center gap-6">
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="image_alt_auto" value="1" class="sr-only peer" {{ settings.image_alt_auto ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Auto-generate alt text from captions</span>
            </label>
            
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="preload_critical_images" value="1" class="sr-only peer" {{ settings.preload_critical_images ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Preload critical images</span>
            </label>
            
            <label class="flex items-center cursor-pointer">
              <input type="checkbox" name="lazy_load_images" value="1" class="sr-only peer" {{ settings.lazy_load_images ? 'checked' : '' }}>
              <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              <span class="ml-3 text-sm font-medium text-gray-900">Enable lazy loading</span>
            </label>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Copyright Notice</label>
            <input type="text" name="image_copyright_notice" class="form-input" value="{{ settings.image_copyright_notice }}" placeholder="© 2024 Your Name. All rights reserved.">
            <p class="text-xs text-gray-500 mt-1">Default copyright notice for images</p>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">License URL</label>
              <input type="url" name="image_license_url" class="form-input" value="{{ settings.image_license_url }}" placeholder="https://creativecommons.org/licenses/by-nc/4.0/">
              <p class="text-xs text-gray-500 mt-1">URL to license terms (e.g., Creative Commons)</p>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">License Purchase Page</label>
              <input type="url" name="image_acquire_license_page" class="form-input" value="{{ settings.image_acquire_license_page }}" placeholder="https://yourwebsite.com/licensing">
              <p class="text-xs text-gray-500 mt-1">Page where visitors can purchase licenses</p>
            </div>
          </div>
        </div>
      </div>
    </form>

    <!-- Separate Sitemap Form -->
    <form id="sitemap-form" method="post" action="{{ base_path }}/admin/seo/sitemap" class="hidden">
      <input type="hidden" name="csrf" value="{{ csrf }}">
    </form>
  </div>
</div>

<script>
// SEO page initialization - Compatible with SPA
function initializeSEOPage() {
  console.log('Initializing SEO page...');
  
  // Local business toggle
  const localBusinessToggle = document.querySelector('input[name="local_business_enabled"]');
  const localBusinessFields = document.getElementById('local-business-fields');
  
  if (localBusinessToggle && localBusinessFields) {
    // Remove any existing event listeners to prevent duplicates
    localBusinessToggle.removeEventListener('change', handleLocalBusinessToggle);
    localBusinessToggle.addEventListener('change', handleLocalBusinessToggle);
    
    // Set initial state
    handleLocalBusinessToggle.call(localBusinessToggle);
  }
  
  // Form validation
  const form = document.getElementById('seo-form');
  if (form) {
    // Remove existing listener to prevent duplicates
    form.removeEventListener('submit', handleSEOFormSubmit);
    form.addEventListener('submit', handleSEOFormSubmit);
  }
  
  console.log('SEO page initialization completed');
}

// Event handler functions
function handleLocalBusinessToggle() {
  const localBusinessFields = document.getElementById('local-business-fields');
  if (localBusinessFields) {
    if (this.checked) {
      localBusinessFields.classList.remove('opacity-50', 'pointer-events-none');
    } else {
      localBusinessFields.classList.add('opacity-50', 'pointer-events-none');
    }
  }
}

function handleSEOFormSubmit(e) {
  const canonicalUrl = document.querySelector('input[name="canonical_base_url"]')?.value;
  const sitemapEnabled = document.querySelector('input[name="sitemap_enabled"]')?.checked;
  
  if (sitemapEnabled && !canonicalUrl) {
    e.preventDefault();
    alert('Please set a canonical base URL when sitemap is enabled.');
    return false;
  }
}

// Initialize on DOM ready
document.addEventListener('DOMContentLoaded', initializeSEOPage);

// Make initialization function globally available for SPA re-initialization
if (!window.pageInitializers) {
  window.pageInitializers = {};
}
window.pageInitializers.seo = initializeSEOPage;

// Auto-initialize if this is loaded in SPA context
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeSEOPage);
} else {
  initializeSEOPage();
}
</script>
{% endblock %}