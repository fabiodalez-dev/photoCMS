{% extends "frontend/_layout.twig" %}

{% block content %}
{# Hook: frontend_category_before - Before entire category page #}
{{ do_action('frontend_category_before', {category: category, albums: albums, base_path: base_path}) }}

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
  {% include 'frontend/_breadcrumbs.twig' %}
</div>
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

    {# Hook: frontend_category_header_before - Before category header #}
    {{ do_action('frontend_category_header_before', {category: category, base_path: base_path}) }}

    <!-- Category header -->
    <div class="text-center py-12">
        <h1 class="text-3xl md:text-4xl font-light text-black mb-6">
            {{ category.name|e }}
        </h1>
        <p class="text-lg text-neutral-600">
            {{ albums|length }} {{ albums|length == 1 ? 'album' : 'albums' }} in this category
        </p>

        {# Hook: frontend_category_header_meta - Add custom metadata to category header #}
        {{ do_action('frontend_category_header_meta', {category: category, base_path: base_path}) }}
    </div>

    {# Hook: frontend_category_header_after - After category header #}
    {{ do_action('frontend_category_header_after', {category: category, base_path: base_path}) }}

    {# Hook: frontend_category_albums_before - Before albums grid #}
    {{ do_action('frontend_category_albums_before', {category: category, albums: albums, base_path: base_path}) }}

    <!-- Albums grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {% for album in albums %}
            {% include "frontend/_album_card.twig" %}
        {% endfor %}
    </div>
    
    {% if albums|length == 0 %}
    <div class="text-center py-20">
        <h2 class="text-2xl font-light text-neutral-600 mb-4">No albums in this category yet</h2>
        <p class="text-neutral-500">
            <a href="{{ base_path }}/" class="hover:text-black transition-colors">Browse all albums</a>
        </p>
    </div>
    {% endif %}

    {# Hook: frontend_category_albums_after - After albums grid #}
    {{ do_action('frontend_category_albums_after', {category: category, albums: albums, base_path: base_path}) }}

</div>

{# Hook: frontend_category_other_before - Before other categories section #}
{{ do_action('frontend_category_other_before', {category: category, categories: categories, base_path: base_path}) }}

<!-- Other categories -->
{% if categories|length > 1 %}
<section class="border-t border-neutral-200 mt-16 pt-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-light text-center mb-12">Other Categories</h2>
        
        <div class="flex flex-wrap justify-center gap-4">
            {% for cat in categories %}
                {% if cat.slug != category.slug %}
                <a href="{{ base_path }}/category/{{ cat.slug }}" 
                   class="text-sm text-neutral-600 hover:text-black border border-neutral-200 rounded px-4 py-2 transition-colors">
                    {{ cat.name|e }}
                </a>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

{# Hook: frontend_category_other_after - After other categories section #}
{{ do_action('frontend_category_other_after', {category: category, categories: categories, base_path: base_path}) }}

{# Hook: frontend_category_after - After entire category page #}
{{ do_action('frontend_category_after', {category: category, albums: albums, base_path: base_path}) }}
{% endblock %}

{% block scripts %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": {{ category.name|json_encode|raw }},
  "url": {{ (canonical_url|default(current_url))|json_encode|raw }},
  "description": {{ meta_description|default('')|json_encode|raw }}
}
</script>
{% endblock %}
