<style nonce="{{ csp_nonce() }}">
/* Ensure mobile search toggle hidden on desktop (reinforce Tailwind md:hidden) */
@media (min-width: 768px) {
  #mobile-search-toggle {
    display: none !important;
  }
}

/* Home Infinite Scroll Styles - container always visible */
.perspective { transform: perspective(1200px) rotateX(1deg); }

/* Mobile masonry via CSS columns */
.home-mobile-wrap { display:block; }
.home-desktop-wrap { display:none; }
@media (min-width:768px){
  .home-mobile-wrap { display:none !important; }
  .home-desktop-wrap { display:flex !important; }
  /* Tablet: show only first 2 columns */
  .home-desktop-wrap .home-col:nth-child(3) { display:none; }
}
@media (min-width:1024px){
  /* Desktop: show all 3 columns */
  .home-desktop-wrap .home-col:nth-child(3) { display:block; }
}
.home-mobile { column-count: 1; column-gap: 1.5rem; }
@media (min-width: 640px) { .home-mobile { column-count: 2; } }
.home-cell { break-inside: avoid; margin-bottom: 1.5rem; }

/* Desktop columns autoscroll */
.home-col { position: relative; flex: 1 1 0; height: 100%; overflow: hidden; }
.home-track { position: absolute; top: 0; left: 0; right: 0; will-change: transform; }
.home-col .home-cell { margin-bottom: 1.5rem; }

.home-col[data-direction="down"] .home-track { 
  animation: homeScrollDown var(--home-duration) linear infinite; 
  animation-delay: var(--home-delay); 
}
.home-col[data-direction="up"] .home-track { 
  animation: homeScrollUp var(--home-duration) linear infinite; 
  animation-delay: var(--home-delay); 
}
@keyframes homeScrollDown { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(0, -50%, 0); } }
@keyframes homeScrollUp { 0% { transform: translate3d(0, -50%, 0); } 100% { transform: translate3d(0, 0, 0); } }

/* Pause only hovered column */
.home-col:hover .home-track { animation-play-state: paused; cursor: grab; }
.home-col:active .home-track { cursor: grabbing; }
.home-track--virtual { animation: none !important; }

/* Veils - Vertical */
.home-veil-top { background: linear-gradient(180deg, rgb(255 255 255) 0%, rgb(255 255 255) 77%, rgb(255 255 255 / 12%) 100%); }
.home-veil-bottom { background: linear-gradient(0deg, rgb(255 255 255) 0%, rgb(255 255 255) 77%, rgb(255 255 255 / 12%) 100%); }
/* Veils - Horizontal */
.home-veil-left { background: linear-gradient(90deg, rgb(255 255 255) 0%, rgb(255 255 255) 77%, rgb(255 255 255 / 12%) 100%); }
.home-veil-right { background: linear-gradient(270deg, rgb(255 255 255) 0%, rgb(255 255 255) 77%, rgb(255 255 255 / 12%) 100%); }

/* Item hover effects & overlay */
.home-item { width: 100%; height: 100%; transition: transform .3s cubic-bezier(.25,.8,.25,1), box-shadow .3s; }
.home-item:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 12px 32px rgba(0,0,0,.15); }
.home-item img { backface-visibility: hidden; }

/* Entry state: hide items only when JS sets the hidden class */
.home-item--hidden { opacity: 0; filter: blur(4px); transform: scale(0.985); transition: opacity .6s ease, filter .6s ease, transform .6s ease; }
.home-item.home-item--revealed { opacity: 1; filter: blur(0); transform: scale(1); transition: opacity .6s ease, filter .6s ease, transform .6s ease; }

/* Albums Horizontal Infinite Carousel */
.albums-carousel-container { margin: 0 -2rem; padding: 0 2rem 1rem 2rem; display: flex; align-items: stretch; }
.albums-carousel-track { display: flex; will-change: transform; transition: transform 0.1s ease-out; align-items: stretch; gap: 16px; }
@media (min-width: 640px) { .albums-carousel-track { gap: 20px; } }
@media (min-width: 768px) { .albums-carousel-track { gap: 24px; } }
@media (min-width: 1024px) { .albums-carousel-track { gap: 28px; } }
.album-carousel-item { min-width: 320px; user-select: none; flex-shrink: 0; }
@media (min-width: 768px) { .album-carousel-item { min-width: 384px; } }
.album-carousel-item img { pointer-events: none; width: 100%; height: 100%; object-fit: cover; }
/* Allow clicks inside album cards (image drag prevented separately) */
.albums-edge-left, .albums-edge-right { position: absolute; top: 0; bottom: 0; width: 100px; pointer-events: none; z-index: 10; }
.albums-edge-left { left: 0; background: linear-gradient(to right, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 30%, rgba(255,255,255,0) 100%); }
.albums-edge-right { right: 0; background: linear-gradient(to left, rgba(255,255,255,1) 0%, rgba(255,255,255,0.8) 30%, rgba(255,255,255,0) 100%); }
.albums-carousel-track.dragging { transition: none; cursor: grabbing; }
.albums-arrow { position: absolute; top: 50%; transform: translateY(-50%); z-index: 20; background: rgba(255,255,255,.9); color: #111; border: 1px solid rgba(0,0,0,.08); width: 40px; height: 40px; border-radius: 9999px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 10px rgba(0,0,0,.08); }
.albums-arrow-left { left: 8px; }
.albums-arrow-right { right: 8px; }
@media (min-width: 768px) { .albums-arrow { width: 44px; height: 44px; } }

/* performance optimizations */
.home-track { backface-visibility: hidden; transform-style: preserve-3d; transform: translateZ(0); will-change: transform; }

@media (max-width: 767px) { .perspective { transform: none; } }

/* Responsive heights for the section - Vertical mode */
.home-vertical { height: 120vh; }
@media (min-width: 768px) { .home-vertical { height: 150vh !important; } }
@media (min-width: 1024px) { .home-vertical { height: 200vh !important; } }

/* ===== HORIZONTAL SCROLL MODE ===== */
.home-horizontal { height: auto !important; width: 100%; overflow: hidden; }

/* Hide horizontal desktop on mobile */
.home-horizontal .home-desktop-horizontal { display: none; }
@media (min-width: 768px) {
  .home-horizontal .home-desktop-horizontal {
    display: flex !important;
    flex-direction: column;
    gap: 1.5rem;
    width: 100%;
    overflow: hidden;
  }
  /* Tablet: show only first 2 rows */
  .home-horizontal .home-desktop-horizontal .home-row:nth-child(3) { display: none; }
}
@media (min-width: 1024px) {
  /* Desktop: show all 3 rows */
  .home-horizontal .home-desktop-horizontal .home-row:nth-child(3) { display: flex; }
}

/* Horizontal rows */
.home-row {
  position: relative;
  width: 100%;
  height: 220px;
  overflow: hidden;
}
@media (min-width: 768px) { .home-row { height: 280px; } }
@media (min-width: 1024px) { .home-row { height: 320px; } }

/* Horizontal track - flex row */
.home-track-h {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  display: flex;
  flex-direction: row;
  align-items: stretch;
  will-change: transform;
  backface-visibility: hidden;
  transform-style: preserve-3d;
  transform: translateZ(0);
  contain: content;
}

/* Horizontal cells */
.home-cell-h {
  flex-shrink: 0;
  height: 100%;
  margin-right: 1.5rem;
}
.home-cell-h .home-item {
  height: 100%;
  width: auto;
}
.home-cell-h .home-item img {
  height: 100%;
  width: auto;
  object-fit: cover;
}

/* Horizontal scroll animations */
.home-row[data-direction="right"] .home-track-h {
  animation: homeScrollRight var(--home-duration) linear infinite;
  animation-delay: var(--home-delay);
}
.home-row[data-direction="left"] .home-track-h {
  animation: homeScrollLeft var(--home-duration) linear infinite;
  animation-delay: var(--home-delay);
}
@keyframes homeScrollRight { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-50%, 0, 0); } }
@keyframes homeScrollLeft { 0% { transform: translate3d(-50%, 0, 0); } 100% { transform: translate3d(0, 0, 0); } }

/* Horizontal mode: no pause on hover, always scrolling */
.home-row .home-track-h { cursor: default; }
.home-row.dragging .home-track-h { animation: none; cursor: grabbing; }
.home-track-h--virtual { animation: none !important; }

/* Horizontal item hover - adjust for horizontal layout */
.home-horizontal .home-item:hover { transform: translateX(-4px) scale(1.02); }

/* Gallery text rich content styles */
.gallery-text-content strong,
.gallery-text-content b { font-weight: 600; }
.gallery-text-content em,
.gallery-text-content i { font-style: italic; }
.gallery-text-content u { text-decoration: underline; }
.gallery-text-content s { text-decoration: line-through; }
.gallery-text-content a { color: #000; text-decoration: underline; }
.gallery-text-content a:hover { opacity: 0.7; }
.gallery-text-content p { margin-bottom: 1em; }
.gallery-text-content p:last-child { margin-bottom: 0; }
.gallery-text-content ul,
.gallery-text-content ol { margin: 1em 0; padding-left: 1.5em; text-align: left; }
.gallery-text-content ul { list-style-type: disc; }
.gallery-text-content ol { list-style-type: decimal; }
.gallery-text-content li { margin-bottom: 0.5em; }
.gallery-text-content blockquote { border-left: 3px solid #e5e7eb; margin: 1em 0; padding-left: 1em; color: #666; font-style: italic; }
.gallery-text-content h2 { font-size: 1.5rem; font-weight: 300; margin: 1.5em 0 0.5em; }
.gallery-text-content h3 { font-size: 1.25rem; font-weight: 400; margin: 1.25em 0 0.5em; }
.gallery-text-content h4 { font-size: 1rem; font-weight: 500; margin: 1em 0 0.5em; }
</style>
