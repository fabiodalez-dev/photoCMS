# COMPREHENSIVE APPLICATION SOURCE CODE SECURITY
# Protect all application source code and configuration files

# Deny all access to application files
<Files "*">
    Require all denied
</Files>

# Block all PHP source code files
<FilesMatch "\.php$">
    Require all denied
</FilesMatch>

# Block template and view files
<FilesMatch "\.(twig|blade|smarty|mustache)$">
    Require all denied
</FilesMatch>

# Block configuration and sensitive data files
<FilesMatch "\.(ini|conf|config|env|json|xml|yml|yaml|log|sql|sqlite|db)$">
    Require all denied
</FilesMatch>

# Block development and documentation files
<FilesMatch "\.(md|txt|rst|changelog|readme|license|gitignore|gitattributes)$">
    Require all denied
</FilesMatch>

# Block backup and temporary files
<FilesMatch "\.(bak|backup|tmp|temp|cache|swp|orig|~|old)$">
    Require all denied
</FilesMatch>

# Prevent directory browsing and script execution
Options -Indexes -ExecCGI

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</IfModule>

# Block access to hidden files and directories
<FilesMatch "^\\.">
    Require all denied
</FilesMatch>

# Disable PHP execution completely
<IfModule mod_php.c>
    php_flag engine off
</IfModule>

# Block common attack patterns and reconnaissance
<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Block direct access to app directory
    RewriteCond %{THE_REQUEST} \s/+app/ [NC]
    RewriteRule . - [F,L]
    
    # Block requests for source code files
    RewriteCond %{REQUEST_URI} \.(php|inc|class|conf|config)$ [NC]
    RewriteRule . - [F,L]
    
    # Block version control access
    RewriteCond %{REQUEST_URI} \.(git|svn|hg)(/|$) [NC]
    RewriteRule . - [F,L]
</IfModule>

# Remove server signature
ServerSignature Off