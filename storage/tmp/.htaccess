# TEMPORARY STORAGE SECURITY
# Block direct access to temporary upload files

# Deny all public access to temporary files
<Files "*">
    Require all denied
</Files>

# Block potentially dangerous file types that might be uploaded
<FilesMatch "\.(php|php3|php4|php5|phtml|pl|py|jsp|asp|sh|cgi|exe|bat|com|scr|vbs|js|jar|pif|msi|dll|htaccess|htpasswd|ini|log|sql)$">
    Require all denied
</FilesMatch>

# Block files without extensions (could be executables)
<FilesMatch "^[^.]*$">
    Require all denied
</FilesMatch>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Cache-Control "no-cache, no-store, must-revalidate"
    Header always set Pragma "no-cache"
    Header always set Expires "0"
</IfModule>

# Prevent directory browsing
Options -Indexes -ExecCGI

# Remove server signature
ServerSignature Off

# Disable PHP execution (if PHP is processed by Apache)
<IfModule mod_php.c>
    php_flag engine off
</IfModule>

# Block access to hidden files
<FilesMatch "^\\.">
    Require all denied
</FilesMatch>